!function e(t,n,r){function s(i,a){if(!n[i]){if(!t[i]){var u="function"==typeof require&&require;if(!a&&u)return u(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[i]={exports:{}};t[i][0].call(l.exports,function(e){var n=t[i][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)s(r[i]);return s}({1:[function(e,t,n){function r(){l=!1,a.length?c=a.concat(c):f=-1,c.length&&s()}function s(){if(!l){var e=setTimeout(r);l=!0;for(var t=c.length;t;){for(a=c,c=[];++f<t;)a&&a[f].run();f=-1,t=c.length}a=null,l=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var a,u=t.exports={},c=[],l=!1,f=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new o(e,t)),1!==c.length||l||setTimeout(s,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],2:[function(e,t,n){t.exports=e("./lib/axios")},{"./lib/axios":4}],3:[function(e,t,n){(function(n){"use strict";var r=e("./../utils"),s=e("./../core/settle"),o=e("./../helpers/buildURL"),i=e("./../helpers/parseHeaders"),a=e("./../helpers/isURLSameOrigin"),u=e("../core/createError"),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||e("./../helpers/btoa");t.exports=function(t){return new Promise(function(l,f){var p=t.data,d=t.headers;r.isFormData(p)&&delete d["Content-Type"];var h=new XMLHttpRequest,m="onreadystatechange",v=!1;if("test"===n.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in h||a(t.url)||(h=new window.XDomainRequest,m="onload",v=!0,h.onprogress=function(){},h.ontimeout=function(){}),t.auth){var y=t.auth.username||"",g=t.auth.password||"";d.Authorization="Basic "+c(y+":"+g)}if(h.open(t.method.toUpperCase(),o(t.url,t.params,t.paramsSerializer),!0),h.timeout=t.timeout,h[m]=function(){if(h&&(4===h.readyState||v)&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var e="getAllResponseHeaders"in h?i(h.getAllResponseHeaders()):null,n=t.responseType&&"text"!==t.responseType?h.response:h.responseText,r={data:n,status:1223===h.status?204:h.status,statusText:1223===h.status?"No Content":h.statusText,headers:e,config:t,request:h};s(l,f,r),h=null}},h.onerror=function(){f(u("Network Error",t)),h=null},h.ontimeout=function(){f(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED")),h=null},r.isStandardBrowserEnv()){var w=e("./../helpers/cookies"),b=(t.withCredentials||a(t.url))&&t.xsrfCookieName?w.read(t.xsrfCookieName):void 0;b&&(d[t.xsrfHeaderName]=b)}if("setRequestHeader"in h&&r.forEach(d,function(e,t){"undefined"==typeof p&&"content-type"===t.toLowerCase()?delete d[t]:h.setRequestHeader(t,e)}),t.withCredentials&&(h.withCredentials=!0),t.responseType)try{h.responseType=t.responseType}catch(e){if("json"!==h.responseType)throw e}"function"==typeof t.onDownloadProgress&&h.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(e){h&&(h.abort(),f(e),h=null)}),void 0===p&&(p=null),h.send(p)})}}).call(this,e("_process"))},{"../core/createError":10,"./../core/settle":13,"./../helpers/btoa":17,"./../helpers/buildURL":18,"./../helpers/cookies":20,"./../helpers/isURLSameOrigin":22,"./../helpers/parseHeaders":24,"./../utils":26,_process:1}],4:[function(e,t,n){"use strict";function r(e){var t=new i(e),n=o(i.prototype.request,t);return s.extend(n,i.prototype,t),s.extend(n,t),n}var s=e("./utils"),o=e("./helpers/bind"),i=e("./core/Axios"),a=e("./defaults"),u=r(a);u.Axios=i,u.create=function(e){return r(s.merge(a,e))},u.Cancel=e("./cancel/Cancel"),u.CancelToken=e("./cancel/CancelToken"),u.isCancel=e("./cancel/isCancel"),u.all=function(e){return Promise.all(e)},u.spread=e("./helpers/spread"),t.exports=u,t.exports.default=u},{"./cancel/Cancel":5,"./cancel/CancelToken":6,"./cancel/isCancel":7,"./core/Axios":8,"./defaults":15,"./helpers/bind":16,"./helpers/spread":25,"./utils":26}],5:[function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},{}],6:[function(e,t,n){"use strict";function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new s(e),t(n.reason))})}var s=e("./Cancel");r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e,t=new r(function(t){e=t});return{token:t,cancel:e}},t.exports=r},{"./Cancel":5}],7:[function(e,t,n){"use strict";t.exports=function(e){return!(!e||!e.__CANCEL__)}},{}],8:[function(e,t,n){"use strict";function r(e){this.defaults=e,this.interceptors={request:new i,response:new i}}var s=e("./../defaults"),o=e("./../utils"),i=e("./InterceptorManager"),a=e("./dispatchRequest"),u=e("./../helpers/isAbsoluteURL"),c=e("./../helpers/combineURLs");r.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),e=o.merge(s,this.defaults,{method:"get"},e),e.baseURL&&!u(e.url)&&(e.url=c(e.baseURL,e.url));var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},o.forEach(["delete","get","head"],function(e){r.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}}),t.exports=r},{"./../defaults":15,"./../helpers/combineURLs":19,"./../helpers/isAbsoluteURL":21,"./../utils":26,"./InterceptorManager":9,"./dispatchRequest":11}],9:[function(e,t,n){"use strict";function r(){this.handlers=[]}var s=e("./../utils");r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){s.forEach(this.handlers,function(t){null!==t&&e(t)})},t.exports=r},{"./../utils":26}],10:[function(e,t,n){"use strict";var r=e("./enhanceError");t.exports=function(e,t,n,s){var o=new Error(e);return r(o,t,n,s)}},{"./enhanceError":12}],11:[function(e,t,n){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var s=e("./../utils"),o=e("./transformData"),i=e("../cancel/isCancel"),a=e("../defaults");t.exports=function(e){r(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=s.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),s.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||a.adapter;return t(e).then(function(t){return r(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(r(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},{"../cancel/isCancel":7,"../defaults":15,"./../utils":26,"./transformData":14}],12:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){return e.config=t,n&&(e.code=n),e.response=r,e}},{}],13:[function(e,t,n){"use strict";var r=e("./createError");t.exports=function(e,t,n){var s=n.config.validateStatus;n.status&&s&&!s(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n)):e(n)}},{"./createError":10}],14:[function(e,t,n){"use strict";var r=e("./../utils");t.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},{"./../utils":26}],15:[function(e,t,n){(function(n){"use strict";function r(e,t){!o.isUndefined(e)&&o.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function s(){var t;return"undefined"!=typeof XMLHttpRequest?t=e("./adapters/xhr"):"undefined"!=typeof n&&(t=e("./adapters/http")),t}var o=e("./utils"),i=e("./helpers/normalizeHeaderName"),a=/^\)\]\}',?\n/,u={"Content-Type":"application/x-www-form-urlencoded"},c={adapter:s(),transformRequest:[function(e,t){return i(t,"Content-Type"),o.isFormData(e)||o.isArrayBuffer(e)||o.isStream(e)||o.isFile(e)||o.isBlob(e)?e:o.isArrayBufferView(e)?e.buffer:o.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):o.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e){e=e.replace(a,"");try{e=JSON.parse(e)}catch(e){}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},o.forEach(["delete","get","head"],function(e){c.headers[e]={}}),o.forEach(["post","put","patch"],function(e){c.headers[e]=o.merge(u)}),t.exports=c}).call(this,e("_process"))},{"./adapters/http":3,"./adapters/xhr":3,"./helpers/normalizeHeaderName":23,"./utils":26,_process:1}],16:[function(e,t,n){"use strict";t.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},{}],17:[function(e,t,n){"use strict";function r(){this.message="String contains an invalid character"}function s(e){for(var t,n,s=String(e),i="",a=0,u=o;s.charAt(0|a)||(u="=",a%1);i+=u.charAt(63&t>>8-a%1*8)){if(n=s.charCodeAt(a+=.75),n>255)throw new r;t=t<<8|n}return i}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",t.exports=s},{}],18:[function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var s=e("./../utils");t.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(s.isURLSearchParams(t))o=t.toString();else{var i=[];s.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(s.isArray(e)&&(t+="[]"),s.isArray(e)||(e=[e]),s.forEach(e,function(e){s.isDate(e)?e=e.toISOString():s.isObject(e)&&(e=JSON.stringify(e)),i.push(r(t)+"="+r(e))}))}),o=i.join("&")}return o&&(e+=(e.indexOf("?")===-1?"?":"&")+o),e}},{"./../utils":26}],19:[function(e,t,n){"use strict";t.exports=function(e,t){return e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"")}},{}],20:[function(e,t,n){"use strict";var r=e("./../utils");t.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,n,s,o,i){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(s)&&a.push("path="+s),r.isString(o)&&a.push("domain="+o),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},{"./../utils":26}],21:[function(e,t,n){"use strict";t.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},{}],22:[function(e,t,n){"use strict";var r=e("./../utils");t.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(s.setAttribute("href",t),t=s.href),s.setAttribute("href",t),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:"/"===s.pathname.charAt(0)?s.pathname:"/"+s.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");return t=e(window.location.href),function(n){var s=r.isString(n)?e(n):n;return s.protocol===t.protocol&&s.host===t.host}}():function(){return function(){return!0}}()},{"./../utils":26}],23:[function(e,t,n){"use strict";var r=e("../utils");t.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},{"../utils":26}],24:[function(e,t,n){"use strict";var r=e("./../utils");t.exports=function(e){var t,n,s,o={};return e?(r.forEach(e.split("\n"),function(e){s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t&&(o[t]=o[t]?o[t]+", "+n:n)}),o):o}},{"./../utils":26}],25:[function(e,t,n){"use strict";t.exports=function(e){return function(t){return e.apply(null,t)}}},{}],26:[function(e,t,n){"use strict";function r(e){return"[object Array]"===x.call(e)}function s(e){return"[object ArrayBuffer]"===x.call(e)}function o(e){return"undefined"!=typeof FormData&&e instanceof FormData}function i(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function a(e){return"string"==typeof e}function u(e){return"number"==typeof e}function c(e){return"undefined"==typeof e}function l(e){return null!==e&&"object"==typeof e}function f(e){return"[object Date]"===x.call(e)}function p(e){return"[object File]"===x.call(e)}function d(e){return"[object Blob]"===x.call(e)}function h(e){return"[object Function]"===x.call(e)}function m(e){return l(e)&&h(e.pipe)}function v(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function y(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function g(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"function"==typeof document.createElement}function w(e,t){if(null!==e&&"undefined"!=typeof e)if("object"==typeof e||r(e)||(e=[e]),r(e))for(var n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}function b(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=b(t[n],e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)w(arguments[n],e);return t}function E(e,t,n){return w(t,function(t,r){n&&"function"==typeof t?e[r]=k(t,n):e[r]=t}),e}var k=e("./helpers/bind"),x=Object.prototype.toString;t.exports={isArray:r,isArrayBuffer:s,isFormData:o,isArrayBufferView:i,isString:a,isNumber:u,isObject:l,isUndefined:c,isDate:f,isFile:p,isBlob:d,isFunction:h,isStream:m,isURLSearchParams:v,isStandardBrowserEnv:g,forEach:w,merge:b,extend:E,trim:y}},{"./helpers/bind":16}],27:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o={emitDelay:10,strictMode:!1},i=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?o:arguments[0];r(this,e);var n=void 0,s=void 0;n=t.hasOwnProperty("emitDelay")?t.emitDelay:o.emitDelay,this._emitDelay=n,s=t.hasOwnProperty("strictMode")?t.strictMode:o.strictMode,this._strictMode=s,this._listeners={},this.events=[]}return s(e,[{key:"_addListenner",value:function(e,t,n){if("function"!=typeof t)throw TypeError("listener must be a function");this.events.indexOf(e)===-1?(this._listeners[e]=[{once:n,fn:t}],this.events.push(e)):this._listeners[e].push({once:n,fn:t})}},{key:"on",value:function(e,t){this._addListenner(e,t,!1)}},{key:"once",value:function(e,t){this._addListenner(e,t,!0)}},{key:"off",value:function(e,t){var n=this,r=this.events.indexOf(e),s=e&&r!==-1;s&&(t?!function(){var s=[],o=n._listeners[e];o.forEach(function(e,n){e.fn===t&&s.unshift(n)}),s.forEach(function(e){o.splice(e,1)}),o.length||(n.events.splice(r,1),delete n._listeners[e])}():(delete this._listeners[e],this.events.splice(r,1)))}},{key:"_applyEvents",value:function(e,t){var n=this._listeners[e];if(n&&n.length){var r=[];n.forEach(function(e,n){e.fn.apply(null,t),e.once&&r.unshift(n)}),r.forEach(function(e){n.splice(e,1)})}else if(this._strictMode)throw"No listeners specified for event: "+e}},{key:"emit",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];this._emitDelay?setTimeout(function(){t._applyEvents.call(t,e,r)},this._emitDelay):this._applyEvents(e,r)}},{key:"emitSync",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this._applyEvents(e,n)}},{key:"destroy",value:function(){this._listeners={},this.events=[]}}]),e}();t.exports=i},{}],28:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("event-emitter-es6"),c=r(u),l=e("axios"),f=r(l),p=function(e){function t(e){s(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),r=n;return n.serverUrl=e.serverUrl,n.token=e.token,n.streamId=e.streamId,n.serverName=null,n.wsEndpoint=null,n.restEndpoint=null,n.layers=[],n.objects=[],n.objectProperties=[],n.name=null,n.history=[],n.ws=null,n.wsReconnectionAttempts=0,n.wsSessionId=null,n.streamFound=!1,n.spkEvents={"ws-session-id":r.setSessionId.bind(r),"live-update":r.liveUpdate.bind(r),"metadata-update":r.metadataUpdate.bind(r),"history-update":r.historyUpdate.bind(r),"volatile-broadcast":r.volatileBroadcast.bind(r),"volatile-message":r.volatileMessage.bind(r),"server-message":r.serverMessage.bind(r),error:r.propagateError.bind(r)},n.handshake(function(e,t){return e?n.emit("error",e):(n.restEndpoint=t.restApi,n.wsEndpoint=t.ws,n.serverName=t.serverName,n.getStream(),n.wsConnectionCheker=setInterval(function(){(!n.ws||3==n.ws.readyState)&&n.wsReconnectionAttempts<20&&(n.wsConnect(),n.wsReconnectionAttempts++)},2e3),void(n.isReadyChecker=setInterval(function(){n.wsSessionId&&n.streamFound&&(n.emit("ready",n.name,n.layers,n.objects,n.history),clearInterval(n.isReadyChecker))},100)))}),n}return i(t,e),a(t,[{key:"handshake",value:function(e){f.default.get(this.serverUrl,{headers:{"speckle-token":this.token}}).then(function(t){e(null,t.data)}).catch(function(t){e(t,null)})}},{key:"wsConnect",value:function(){var e=this;this.ws=new WebSocket(this.wsEndpoint+"/?access_token="+this.token),this.ws.onopen=function(){e.wsReconnectionAttempts=0,e.ws.send(JSON.stringify({eventName:"join-stream",args:{streamid:e.streamId,role:"receiver"}}))},this.ws.onmessage=function(t){if("ping"===t.data)return e.ws.send("alive");var n=JSON.parse(t.data);return e.spkEvents.hasOwnProperty(n.eventName)?void e.spkEvents[n.eventName](n):e.emit("error","Undefined event received.")},this.ws.onclose=function(e){console.log(e),console.log("Socket closed.")}}},{key:"getStream",value:function(){var e=this;console.log("Attempting to retrieve stream.");var t=this;f.default.get(this.restEndpoint+"/streams/"+this.streamId+"/data/",{headers:{"speckle-token":this.token,"speckle-ws-id":this.wsSessionId}}).then(function(n){return n.data.success?(t.layers=n.data.data.layers,t.objects=n.data.data.objects,t.objectProperties=n.data.data.objectProperties,t.name=n.data.data.name,t.objectProperties.forEach(function(e){t.objects[e.objectIndex].properties=e.properties}),f.default.get(e.restEndpoint+"/streams/"+e.streamId,{headers:{"speckle-token":e.token,"speckle-ws-id":e.wsSessionId}})):e.emit("error",n.message)}).then(function(n){return n.data.success?(t.history=n.data.data.history,void(t.streamFound=!0)):e.emit("error",n.message)}).catch(function(t){e.emit("error",t)})}},{key:"setSessionId",value:function(e){this.wsSessionId=e.sessionId}},{key:"getObjects",value:function(e){for(var t=this,n=[],r=this.objects,s=0;s<r.length;s++)n.push("placeholder");var o=0;r.forEach(function(s,i){t.getObject(s,function(s){if(n.splice(i,1,s),t.emit("object-load-progress",o),++o>=r.length)return e(n)})})}},{key:"getObject",value:function(e,t){if(!e)throw new Error("no obj provided");return e.hash.indexOf("NoHash")>=0?t(e):void f.default.get(this.restEndpoint+"/geometry/"+e.hash).then(function(n){var r=n.data.data;return r.properties=e.properties,t(r)}).catch(function(e){throw new Error(e)})}},{key:"broadcast",value:function(e){if(!this.streamId)throw new Error("No streamId, where should I broadcast?");this.ws.send(JSON.stringify({eventName:"volatile-broadcast",args:JSON.stringify(e)}))}},{key:"sendMessage",value:function(e,t){if(!this.streamId||!t)throw new Error("No streamId or recipient. Meeep!");this.ws.send(JSON.stringify({eventName:"volatile-message",args:{message:JSON.stringify(e),recipient:t}}))}},{key:"liveUpdate",value:function(e){this.name=e.args.name,this.layers=e.args.layers,this.objects=e.args.objects,this.objectProperties=e.args.objectProperties,this.emit("live-update",e.args.name,e.args.layers,e.args.objects,e.args.objectProperties)}},{key:"metadataUpdate",value:function(e){this.name=e.args.name,this.layers=e.args.layers,this.emit("metadata-update",e.args.name,e.args.layers)}},{key:"historyUpdate",value:function(e){this.history=e.args,this.emit("history-update",e.args)}},{key:"volatileBroadcast",value:function(e){this.emit("volatile-broadcast",e)}},{key:"volatileMessage",value:function(e){console.log("!!! Got a volatile message"),this.emit("volatile-message",e)}},{key:"serverMessage",value:function(e){this.emit("server-message",e)}},{key:"propagateError",value:function(e){this.emit("error",e)}},{key:"dispose",value:function(){this.ws.close(),this.ws=null,clearInterval(this.isReadyChecker),clearInterval(this.wsConnectionCheker)}}]),t}(c.default);n.default=p},{axios:2,"event-emitter-es6":27}],29:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var s=e("./SpeckleReceiver"),o=r(s);window.SpeckleReceiver=o.default},{"./SpeckleReceiver":28}]},{},[29]);
